#!/usr/bin/env node

/**
 * Setup script for Mock API system
 * This script helps configure the mock API environment
 */

const fs = require('fs');
const path = require('path');

const PROJECT_ROOT = path.join(__dirname, '..');
const ENV_LOCAL_PATH = path.join(PROJECT_ROOT, '.env.local');

console.log('ðŸŽ­ Mock API Setup Script');
console.log('========================\n');

// Check if .env.local exists
if (fs.existsSync(ENV_LOCAL_PATH)) {
  console.log('ðŸ“„ Found existing .env.local file');
  
  // Read current content
  const currentContent = fs.readFileSync(ENV_LOCAL_PATH, 'utf8');
  
  // Check if mock API is already configured
  if (currentContent.includes('NEXT_PUBLIC_MOCK_API')) {
    console.log('âœ… Mock API configuration already exists');
    
    // Show current status
    const mockApiMatch = currentContent.match(/NEXT_PUBLIC_MOCK_API=(.+)/);
    if (mockApiMatch) {
      const isEnabled = mockApiMatch[1].trim() === 'true';
      console.log(`ðŸ“Š Current status: ${isEnabled ? 'ENABLED' : 'DISABLED'}`);
    }
  } else {
    console.log('âž• Adding Mock API configuration to .env.local');
    
    // Add mock API configuration
    const newContent = currentContent + '\n# Mock API Configuration\nNEXT_PUBLIC_MOCK_API=true\n';
    fs.writeFileSync(ENV_LOCAL_PATH, newContent);
    console.log('âœ… Mock API configuration added');
  }
} else {
  console.log('ðŸ“„ Creating new .env.local file');
  
  // Create .env.local with mock API configuration
  const envContent = `# Environment Configuration
# Generated by setup-mock-api.js

# API Configuration
NEXT_PUBLIC_API_BASE=https://cooly-ai.onrender.com

# Mock API Configuration (Development Only)
# Set to 'true' to enable mock API mode - no real API calls will be made
NEXT_PUBLIC_MOCK_API=true

# Debug Configuration
NEXT_PUBLIC_DEBUG_LOGS=true
`;

  fs.writeFileSync(ENV_LOCAL_PATH, envContent);
  console.log('âœ… .env.local file created with Mock API enabled');
}

console.log('\nðŸš€ Next Steps:');
console.log('1. Restart your development server: npm run dev');
console.log('2. Look for the "MOCK API" indicator in the top-right corner');
console.log('3. All API calls will now use mock responses');
console.log('4. Check the browser console for mock API logs');

console.log('\nðŸ’¡ Tips:');
console.log('- Mock responses include realistic delays and occasional errors');
console.log('- Use mock mode for development to save on API costs');
console.log('- Switch to live mode only for final testing');
console.log('- See MOCK_API_GUIDE.md for detailed documentation');

console.log('\nðŸ’° Cost Savings:');
console.log('- AI Generation APIs: $0.01-$0.10 per request');
console.log('- Image Processing: $0.001-$0.01 per image');
console.log('- Video Generation: $0.10-$1.00 per video');
console.log('- Potential daily savings: $10-100+ during development');

console.log('\nðŸŽ­ Mock API Setup Complete!');
